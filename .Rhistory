annotate("text", label = "\n\nWATER", x = 3.5, y = Inf)+
annotate("text", label = "\n\nDMSO", x = 2.48, y = Inf)+
geom_vline(xintercept = WATER_start, linetype="longdash")+
geom_vline(xintercept = WATER_stop, linetype="longdash")+
geom_vline(xintercept = DMSO_start, linetype="dashed")+
geom_vline(xintercept = DMSO_stop, linetype="dashed")
source("1-processing.R")
gg_nmr+
geom_path(data=spectra, aes(x = ppm, y = intensity, color = source))+
# if you need to add labels:
annotate("text", label = "aliphatic", x = 1.4, y = -500)+
annotate("text", label = "O-alkyl", x = 3.5, y = -500)+
annotate("text", label = "alpha-H\n (protein)", x = 4.45, y = -600)+
annotate("text", label = "aromatic", x = 7, y = -500)+
annotate("text", label = "amide", x = 8.1, y = -500)+
annotate("text", label = "\n\nWATER", x = 3.5, y = Inf)+
annotate("text", label = "\n\nDMSO", x = 2.48, y = Inf)+
geom_vline(xintercept = WATER_start, linetype="longdash")+
geom_vline(xintercept = WATER_stop, linetype="longdash")+
geom_vline(xintercept = DMSO_start, linetype="dashed")+
geom_vline(xintercept = DMSO_stop, linetype="dashed")
gg_nmr+
geom_path(data=spectra, aes(x = ppm, y = intensity, color = source))+
ylim(0,100000)+
# if you need to add labels:
annotate("text", label = "aliphatic", x = 1.4, y = -500)+
annotate("text", label = "O-alkyl", x = 3.5, y = -500)+
annotate("text", label = "alpha-H\n (protein)", x = 4.45, y = -600)+
annotate("text", label = "aromatic", x = 7, y = -500)+
annotate("text", label = "amide", x = 8.1, y = -500)+
annotate("text", label = "\n\nWATER", x = 3.5, y = Inf)+
annotate("text", label = "\n\nDMSO", x = 2.48, y = Inf)+
geom_vline(xintercept = WATER_start, linetype="longdash")+
geom_vline(xintercept = WATER_stop, linetype="longdash")+
geom_vline(xintercept = DMSO_start, linetype="dashed")+
geom_vline(xintercept = DMSO_stop, linetype="dashed")
gg_nmr+
geom_path(data=spectra, aes(x = ppm, y = intensity, color = source))+
ylim(0,30000)+
# if you need to add labels:
annotate("text", label = "aliphatic", x = 1.4, y = -500)+
annotate("text", label = "O-alkyl", x = 3.5, y = -500)+
annotate("text", label = "alpha-H\n (protein)", x = 4.45, y = -600)+
annotate("text", label = "aromatic", x = 7, y = -500)+
annotate("text", label = "amide", x = 8.1, y = -500)+
annotate("text", label = "\n\nWATER", x = 3.5, y = Inf)+
annotate("text", label = "\n\nDMSO", x = 2.48, y = Inf)+
geom_vline(xintercept = WATER_start, linetype="longdash")+
geom_vline(xintercept = WATER_stop, linetype="longdash")+
geom_vline(xintercept = DMSO_start, linetype="dashed")+
geom_vline(xintercept = DMSO_stop, linetype="dashed")
gg_nmr+
geom_path(data=spectra, aes(x = ppm, y = intensity, color = source))+
expand_limits(y=c(NA, 30000))+
# if you need to add labels:
annotate("text", label = "aliphatic", x = 1.4, y = -500)+
annotate("text", label = "O-alkyl", x = 3.5, y = -500)+
annotate("text", label = "alpha-H\n (protein)", x = 4.45, y = -600)+
annotate("text", label = "aromatic", x = 7, y = -500)+
annotate("text", label = "amide", x = 8.1, y = -500)+
annotate("text", label = "\n\nWATER", x = 3.5, y = Inf)+
annotate("text", label = "\n\nDMSO", x = 2.48, y = Inf)+
geom_vline(xintercept = WATER_start, linetype="longdash")+
geom_vline(xintercept = WATER_stop, linetype="longdash")+
geom_vline(xintercept = DMSO_start, linetype="dashed")+
geom_vline(xintercept = DMSO_stop, linetype="dashed")
gg_nmr+
geom_path(data=spectra, aes(x = ppm, y = intensity, color = source))+
expand_limits(y=c(NA, 35000))+
# if you need to add labels:
annotate("text", label = "aliphatic", x = 1.4, y = -500)+
annotate("text", label = "O-alkyl", x = 3.5, y = -500)+
annotate("text", label = "alpha-H\n (protein)", x = 4.45, y = -600)+
annotate("text", label = "aromatic", x = 7, y = -500)+
annotate("text", label = "amide", x = 8.1, y = -500)+
annotate("text", label = "\n\nWATER", x = 3.5, y = Inf)+
annotate("text", label = "\n\nDMSO", x = 2.48, y = Inf)+
geom_vline(xintercept = WATER_start, linetype="longdash")+
geom_vline(xintercept = WATER_stop, linetype="longdash")+
geom_vline(xintercept = DMSO_start, linetype="dashed")+
geom_vline(xintercept = DMSO_stop, linetype="dashed")
gg_nmr+
geom_path(data=spectra, aes(x = ppm, y = intensity, color = source))+
expand_limits(y=25000)+
# if you need to add labels:
annotate("text", label = "aliphatic", x = 1.4, y = -500)+
annotate("text", label = "O-alkyl", x = 3.5, y = -500)+
annotate("text", label = "alpha-H\n (protein)", x = 4.45, y = -600)+
annotate("text", label = "aromatic", x = 7, y = -500)+
annotate("text", label = "amide", x = 8.1, y = -500)+
annotate("text", label = "\n\nWATER", x = 3.5, y = Inf)+
annotate("text", label = "\n\nDMSO", x = 2.48, y = Inf)+
geom_vline(xintercept = WATER_start, linetype="longdash")+
geom_vline(xintercept = WATER_stop, linetype="longdash")+
geom_vline(xintercept = DMSO_start, linetype="dashed")+
geom_vline(xintercept = DMSO_stop, linetype="dashed")
gg_nmr+
geom_path(data=spectra, aes(x = ppm, y = intensity, color = source))+
ylim(-700,25000)+
#expand_limits(y=c(NA, 35000))+
# if you need to add labels:
annotate("text", label = "aliphatic", x = 1.4, y = -500)+
annotate("text", label = "O-alkyl", x = 3.5, y = -500)+
annotate("text", label = "alpha-H\n (protein)", x = 4.45, y = -600)+
annotate("text", label = "aromatic", x = 7, y = -500)+
annotate("text", label = "amide", x = 8.1, y = -500)+
annotate("text", label = "\n\nWATER", x = 3.5, y = Inf)+
annotate("text", label = "\n\nDMSO", x = 2.48, y = Inf)+
geom_vline(xintercept = WATER_start, linetype="longdash")+
geom_vline(xintercept = WATER_stop, linetype="longdash")+
geom_vline(xintercept = DMSO_start, linetype="dashed")+
geom_vline(xintercept = DMSO_stop, linetype="dashed")
gg_nmr+
geom_path(data=spectra2, aes(x = ppm, y = intensity, color = source))+
# if you need to add labels:
annotate("text", label = "aliphatic", x = 1.4, y = -500)+
annotate("text", label = "O-alkyl", x = 3.5, y = -500)+
annotate("text", label = "alpha-H\n (protein)", x = 4.45, y = -600)+
annotate("text", label = "aromatic", x = 7, y = -500)+
annotate("text", label = "amide", x = 8.1, y = -500)+
annotate("text", label = "\n\nWATER", x = 3.5, y = Inf)+
annotate("text", label = "\n\nDMSO", x = 2.48, y = Inf)+
geom_vline(xintercept = WATER_start, linetype="longdash")+
geom_vline(xintercept = WATER_stop, linetype="longdash")+
geom_vline(xintercept = DMSO_start, linetype="dashed")+
geom_vline(xintercept = DMSO_stop, linetype="dashed")
gg_nmr+
geom_path(data=spectra, aes(x = ppm, y = intensity, color = source))+
ylim(-700,25000)+
xlim(0,10)+
#expand_limits(y=c(NA, 35000))+
# if you need to add labels:
annotate("text", label = "aliphatic", x = 1.4, y = -500)+
annotate("text", label = "O-alkyl", x = 3.5, y = -500)+
annotate("text", label = "alpha-H\n (protein)", x = 4.45, y = -600)+
annotate("text", label = "aromatic", x = 7, y = -500)+
annotate("text", label = "amide", x = 8.1, y = -500)+
annotate("text", label = "\n\nWATER", x = 3.5, y = Inf)+
annotate("text", label = "\n\nDMSO", x = 2.48, y = Inf)+
geom_vline(xintercept = WATER_start, linetype="longdash")+
geom_vline(xintercept = WATER_stop, linetype="longdash")+
geom_vline(xintercept = DMSO_start, linetype="dashed")+
geom_vline(xintercept = DMSO_stop, linetype="dashed")
gg_nmr+
geom_path(data=spectra, aes(x = ppm, y = intensity, color = source))+
ylim(-700,25000)+
#expand_limits(y=c(NA, 35000))+
# if you need to add labels:
annotate("text", label = "aliphatic", x = 1.4, y = -500)+
annotate("text", label = "O-alkyl", x = 3.5, y = -500)+
annotate("text", label = "alpha-H\n (protein)", x = 4.45, y = -600)+
annotate("text", label = "aromatic", x = 7, y = -500)+
annotate("text", label = "amide", x = 8.1, y = -500)+
annotate("text", label = "\n\nWATER", x = 3.5, y = Inf)+
annotate("text", label = "\n\nDMSO", x = 2.48, y = Inf)+
geom_vline(xintercept = WATER_start, linetype="longdash")+
geom_vline(xintercept = WATER_stop, linetype="longdash")+
geom_vline(xintercept = DMSO_start, linetype="dashed")+
geom_vline(xintercept = DMSO_stop, linetype="dashed")
## 3. spectra plot parameters ----
gg_nmr =
ggplot()+
geom_rect(data=bins2, aes(xmin=start, xmax=stop, ymin=-Inf, ymax=+Inf, fill=group), color="grey70",alpha=0.1)+
scale_x_reverse(lims(0,10))+
xlab("shift, ppm")+
ylab("intensity")+
theme_bw() %+replace%
theme(legend.position = "right",
legend.key=element_blank(),
legend.title = element_blank(),
legend.text = element_text(size = 12),
legend.key.size = unit(1.5, 'lines'),
panel.border = element_rect(color="black",size=1.5, fill = NA),
plot.title = element_text(hjust = 0.05, size = 14),
axis.text = element_text(size = 14, color = "black"),
axis.title = element_text(size = 14, face = "bold", color = "black"),
# formatting for facets
panel.background = element_blank(),
strip.background = element_rect(colour="white", fill="white"), #facet formatting
panel.spacing.x = unit(1.5, "lines"), #facet spacing for x axis
panel.spacing.y = unit(1.5, "lines"), #facet spacing for x axis
strip.text.x = element_text(size=12, face="bold"), #facet labels
strip.text.y = element_text(size=12, face="bold", angle = 270) #facet labels
)
## 3. spectra plot parameters ----
gg_nmr =
ggplot()+
geom_rect(data=bins2, aes(xmin=start, xmax=stop, ymin=-Inf, ymax=+Inf, fill=group), color="grey70",alpha=0.1)+
scale_x_reverse(lims(0,10))+
xlab("shift, ppm")+
ylab("intensity")+
theme_bw() %+replace%
theme(legend.position = "right",
legend.key=element_blank(),
legend.title = element_blank(),
legend.text = element_text(size = 12),
legend.key.size = unit(1.5, 'lines'),
panel.border = element_rect(color="black",size=1.5, fill = NA),
plot.title = element_text(hjust = 0.05, size = 14),
axis.text = element_text(size = 14, color = "black"),
axis.title = element_text(size = 14, face = "bold", color = "black"),
# formatting for facets
panel.background = element_blank(),
strip.background = element_rect(colour="white", fill="white"), #facet formatting
panel.spacing.x = unit(1.5, "lines"), #facet spacing for x axis
panel.spacing.y = unit(1.5, "lines"), #facet spacing for x axis
strip.text.x = element_text(size=12, face="bold"), #facet labels
strip.text.y = element_text(size=12, face="bold", angle = 270) #facet labels
)
## 3. spectra plot parameters ----
gg_nmr =
ggplot()+
geom_rect(data=bins2, aes(xmin=start, xmax=stop, ymin=-Inf, ymax=+Inf, fill=group), color="grey70",alpha=0.1)+
scale_x_reverse(limits=c(0,10))+
xlab("shift, ppm")+
ylab("intensity")+
theme_bw() %+replace%
theme(legend.position = "right",
legend.key=element_blank(),
legend.title = element_blank(),
legend.text = element_text(size = 12),
legend.key.size = unit(1.5, 'lines'),
panel.border = element_rect(color="black",size=1.5, fill = NA),
plot.title = element_text(hjust = 0.05, size = 14),
axis.text = element_text(size = 14, color = "black"),
axis.title = element_text(size = 14, face = "bold", color = "black"),
# formatting for facets
panel.background = element_blank(),
strip.background = element_rect(colour="white", fill="white"), #facet formatting
panel.spacing.x = unit(1.5, "lines"), #facet spacing for x axis
panel.spacing.y = unit(1.5, "lines"), #facet spacing for x axis
strip.text.x = element_text(size=12, face="bold"), #facet labels
strip.text.y = element_text(size=12, face="bold", angle = 270) #facet labels
)
gg_nmr+
geom_path(data=spectra, aes(x = ppm, y = intensity, color = source))+
ylim(-700,25000)+
#expand_limits(y=c(NA, 35000))+
# if you need to add labels:
annotate("text", label = "aliphatic", x = 1.4, y = -500)+
annotate("text", label = "O-alkyl", x = 3.5, y = -500)+
annotate("text", label = "alpha-H\n (protein)", x = 4.45, y = -600)+
annotate("text", label = "aromatic", x = 7, y = -500)+
annotate("text", label = "amide", x = 8.1, y = -500)+
annotate("text", label = "\n\nWATER", x = 3.5, y = Inf)+
annotate("text", label = "\n\nDMSO", x = 2.48, y = Inf)+
geom_vline(xintercept = WATER_start, linetype="longdash")+
geom_vline(xintercept = WATER_stop, linetype="longdash")+
geom_vline(xintercept = DMSO_start, linetype="dashed")+
geom_vline(xintercept = DMSO_stop, linetype="dashed")
## 3. spectra plot parameters ----
gg_nmr =
ggplot()+
geom_rect(data=bins2, aes(xmin=start, xmax=stop, ymin=-Inf, ymax=+Inf, fill=group), color="grey70",alpha=0.1)+
scale_x_reverse()+
xlab("shift, ppm")+
ylab("intensity")+
theme_bw() %+replace%
theme(legend.position = "right",
legend.key=element_blank(),
legend.title = element_blank(),
legend.text = element_text(size = 12),
legend.key.size = unit(1.5, 'lines'),
panel.border = element_rect(color="black",size=1.5, fill = NA),
plot.title = element_text(hjust = 0.05, size = 14),
axis.text = element_text(size = 14, color = "black"),
axis.title = element_text(size = 14, face = "bold", color = "black"),
# formatting for facets
panel.background = element_blank(),
strip.background = element_rect(colour="white", fill="white"), #facet formatting
panel.spacing.x = unit(1.5, "lines"), #facet spacing for x axis
panel.spacing.y = unit(1.5, "lines"), #facet spacing for x axis
strip.text.x = element_text(size=12, face="bold"), #facet labels
strip.text.y = element_text(size=12, face="bold", angle = 270) #facet labels
)
gg_nmr+
geom_path(data=spectra[(spectra$ppm>0&spectra$ppm<10),], aes(x = ppm, y = intensity, color = source))+
ylim(-700,25000)+
#expand_limits(y=c(NA, 35000))+
# if you need to add labels:
annotate("text", label = "aliphatic", x = 1.4, y = -500)+
annotate("text", label = "O-alkyl", x = 3.5, y = -500)+
annotate("text", label = "alpha-H\n (protein)", x = 4.45, y = -600)+
annotate("text", label = "aromatic", x = 7, y = -500)+
annotate("text", label = "amide", x = 8.1, y = -500)+
annotate("text", label = "\n\nWATER", x = 3.5, y = Inf)+
annotate("text", label = "\n\nDMSO", x = 2.48, y = Inf)+
geom_vline(xintercept = WATER_start, linetype="longdash")+
geom_vline(xintercept = WATER_stop, linetype="longdash")+
geom_vline(xintercept = DMSO_start, linetype="dashed")+
geom_vline(xintercept = DMSO_stop, linetype="dashed")
View(bins2)
bins_long =
bins2 %>%
gather(ppm,cuts,start:stop)
View(bins_long)
View(spectra2)
spectra2 =
spectra2 %>%
dplyr::mutate(grouping = cut(ppm,
breaks = bins_long$cuts,
labels = bins_long$group))
spectra3 =
spectra2 %>%
inner_join(bins2) %>%
filter(between(ppm, start, end))
spectra3 = subset(merge(spectra2, bins2), start <= ppm & ppm <= stop)
View(spectra3)
spectra3 =
subset(merge(spectra2, bins2), start <= ppm & ppm <= stop) %>%
dplyr::select(source,ppm, intensity, group)
gg_nmr+
geom_path(spectra3, aes(x = ppm,y = intensity, color=source))
gg_nmr+
geom_path(data=spectra3, aes(x = ppm,y = intensity, color=source))
gg_nmr+
geom_point(data=spectra3, aes(x = ppm,y = intensity, color=source))
## CLEANING
spectra2 =
spectra %>%
# retain only values 0-10ppm
filter(ppm>=0&ppm<=10) %>%
# remove water and DMSO regions
filter(!(ppm>DMSO_start&ppm<WATER_stop)) %>%
filter(!(ppm>DMSO_start&ppm<DMSO_stop))
spectra3 =
subset(merge(spectra2, bins2), start <= ppm & ppm <= stop) %>%
dplyr::select(source,ppm, intensity, group)
gg_nmr+
geom_point(data=spectra3, aes(x = ppm,y = intensity, color=source))
gg_nmr+
geom_path(data=spectra3, aes(x = ppm,y = intensity, color=source))
spectra3 =
subset(merge(spectra2, bins2), start <= ppm & ppm <= stop) %>%
dplyr::select(source,ppm, intensity, group) %>%
group_by(source, group) %>%
dplyr::mutate(total = sum(intensity))
spectra3 =
subset(merge(spectra2, bins2), start <= ppm & ppm <= stop) %>%
dplyr::select(source,ppm, intensity, group) %>%
group_by(source, group) %>%
dplyr::summarize(intensity = sum(intensity))
spectra3 =
subset(merge(spectra2, bins2), start <= ppm & ppm <= stop) %>%
dplyr::select(source,ppm, intensity, group) %>%
group_by(source, group) %>%
dplyr::summarize(intensity = sum(intensity)) %>%
group_by(source) %>%
dplyr::mutate(total = sum(intensity),
relabund = (intensity/total)*100)
spectra3 =
subset(merge(spectra2, bins2), start <= ppm & ppm <= stop) %>%
dplyr::select(source,ppm, intensity, group) %>%
group_by(source, group) %>%
dplyr::summarize(intensity = sum(intensity)) %>%
group_by(source) %>%
dplyr::mutate(total = sum(intensity),
relabund = round((intensity/total)*100),2)
spectra3 =
subset(merge(spectra2, bins2), start <= ppm & ppm <= stop) %>%
dplyr::select(source,ppm, intensity, group) %>%
group_by(source, group) %>%
dplyr::summarize(intensity = sum(intensity)) %>%
group_by(source) %>%
dplyr::mutate(total = sum(intensity),
relabund = round((intensity/total)*100,2))
ggplot(spectra3, aes(y = relabund, color = group))+
coord_polar("y")
ggplot(spectra3, aes(y = relabund, fill = group))+
coord_polar("y")
ggplot(spectra3, aes(x="",y = relabund, fill = group))+
coord_polar("y")
ggplot(spectra3, aes(y="",x = relabund, fill = group))+
coord_polar("y")
ggplot(spectra3, aes(x="",y = relabund, fill = group))+
coord_polar("y")
ggplot(spectra3, aes(x="",y = relabund, fill = group))+
geom_bar(width = 1, stat = "identity")+
coord_polar("y")
ggplot(spectra3, aes(x="",y = relabund, fill = group))+
geom_bar(width = 1, stat = "identity")+
coord_polar("y")+
facet_wrap(source)
ggplot(spectra3, aes(x="",y = relabund, fill = group))+
geom_bar(width = 1, stat = "identity")+
coord_polar("y")+
facet_wrap(~source)
ggplot(spectra3, aes(x="",y = relabund, fill = group))+
geom_bar(width = 1, stat = "identity")+
coord_polar("y")+
geom_text(aes(y = relabund/3 + c(0, cumsum(relabund)[-length(relabund)]),
label = percent(relabund/100)), size=5)
ggplot(spectra3, aes(x="",y = relabund, fill = group))+
geom_bar(width = 1, stat = "identity")+
coord_polar("y")+
geom_text(aes(y = relabund/3 + c(0, cumsum(relabund)[-length(relabund)]),
label = relabund), size=5)
ggplot(spectra3, aes(x="",y = relabund, fill = group))+
geom_bar(width = 1, stat = "identity")+
coord_polar("y")+
geom_text(aes(y = relabund/3 + c(0, cumsum(relabund)[-length(relabund)]),
label = relabund), size=5)+
facet_wrap(~source)
ggplot(spectra3, aes(x="",y = relabund, fill = group))+
geom_bar(width = 1, stat = "identity")+
coord_polar("y")+
geom_text(aes(y = relabund/3 + c(0, cumsum(relabund)[-length(relabund)]),
label = relabund), size=2)+
facet_wrap(~source)
ggplot(spectra3, aes(x="",y = relabund, fill = group))+
geom_bar(width = 1, stat = "identity")+
coord_polar("y")+
geom_text(aes(y = relabund + c(0, cumsum(relabund)[-length(relabund)]),
label = relabund), size=2)+
facet_wrap(~source)
ggplot(spectra3, aes(x="",y = relabund, fill = group))+
geom_bar(width = 1, stat = "identity")+
coord_polar("y")+
geom_text(aes(y = relabund,
label = relabund), size=2)+
facet_wrap(~source)
ggplot(spectra3, aes(x="",y = relabund, fill = group))+
geom_bar(width = 1, stat = "identity")+
coord_polar("y")+
geom_text(aes(
label = relabund), size=2)+
facet_wrap(~source)
label = relabund), size=3)+
facet_wrap(~source)
ggplot(spectra3, aes(x="",y = relabund, fill = group))+
geom_bar(width = 1, stat = "identity")+
coord_polar("y")+
geom_text(aes(
label = relabund), size=3)+
facet_wrap(~source)
spectra3 =
subset(merge(spectra2, bins2), start <= ppm & ppm <= stop) %>%
dplyr::select(source,ppm, intensity, group) %>%
group_by(source, group) %>%
dplyr::summarize(intensity = sum(intensity)) %>%
group_by(source) %>%
dplyr::mutate(total = sum(intensity),
relabund = round((intensity/total)*100,2))%>%
mutate(pos = cumsum(relabund)- relabund/2)
ggplot(data=spectra, aes(x="", y=relabund, fill=factor(group))) +
geom_bar(stat="identity") +
geom_text(aes(x= "", y=pos, label = relabund), size=10) +  # note y = pos
facet_grid(facets = .~source, labeller = label_value) +
coord_polar(theta = "y")
ggplot(data=spectra3, aes(x="", y=relabund, fill=factor(group))) +
geom_bar(stat="identity") +
geom_text(aes(x= "", y=pos, label = relabund), size=10) +  # note y = pos
facet_grid(facets = .~source, labeller = label_value) +
coord_polar(theta = "y")
ggplot(data=spectra3, aes(x="", y=relabund, fill=factor(group))) +
geom_bar(stat="identity") +
geom_text(aes(x= "", y=pos, label = relabund), size=1) +  # note y = pos
facet_grid(facets = .~source, labeller = label_value) +
coord_polar(theta = "y")
ggplot(data=spectra3, aes(x="", y=relabund, fill=factor(group))) +
geom_bar(stat="identity") +
geom_text(aes(x= "", y=pos, label = relabund), size=4) +  # note y = pos
facet_grid(facets = .~source, labeller = label_value) +
coord_polar(theta = "y")
ggplot(data=spectra3, aes(x="", y=relabund, fill=factor(group))) +
geom_bar(stat="identity") +
geom_text(aes(x= "", y=pos, label = relabund), size=4)
ggplot(data=spectra3, aes(x="", y=relabund, fill=factor(group))) +
geom_bar(stat="identity") +
#geom_text(aes(x= "", y=pos, label = relabund), size=4) +  # note y = pos
facet_grid(facets = .~source, labeller = label_value) +
coord_polar(theta = "y")
ggplot(data=spectra3, aes(x="", y=relabund, fill=factor(group))) +
geom_bar(stat="identity") +
#geom_text(aes(x= "", y=pos, label = relabund), size=4) +  # note y = pos
facet_grid(facets = .~source, labeller = label_value) +
coord_polar(theta = "y")+theme_bw()
ggplot(data=spectra3, aes(x="", y=relabund, fill=factor(group))) +
geom_bar(stat="identity", alpha=0.1) +
#geom_text(aes(x= "", y=pos, label = relabund), size=4) +  # note y = pos
facet_grid(facets = .~source, labeller = label_value) +
coord_polar(theta = "y")+theme_bw()
ggplot(data=spectra3, aes(x="", y=relabund, fill=factor(group))) +
geom_bar(stat="identity", alpha=0.5) +
#geom_text(aes(x= "", y=pos, label = relabund), size=4) +  # note y = pos
facet_grid(facets = .~source, labeller = label_value) +
coord_polar(theta = "y")+theme_bw()
ggplot(data=spectra3, aes(x="", y=relabund, fill=(group))) +
geom_bar(stat="identity", alpha=0.5) +
#geom_text(aes(x= "", y=pos, label = relabund), size=4) +  # note y = pos
facet_grid(facets = .~source, labeller = label_value) +
coord_polar(theta = "y")+theme_bw()
ggplot(data=spectra3, aes(x="", y=relabund, fill=group)) +
geom_bar(stat="identity", alpha=0.5) +
#geom_text(aes(x= "", y=pos, label = relabund), size=4) +  # note y = pos
facet_grid(facets = .~source, labeller = label_value) +
coord_polar(theta = "y")+theme_bw()
ggplot(data=spectra3, aes(x="", y=relabund, fill=group)) +
geom_bar(stat="identity", alpha=0.5) +
#geom_text(aes(x= "", y=pos, label = relabund), size=4) +  # note y = pos
facet_grid(facets = .~source, labeller = label_value) +
coord_polar(theta = "y")+theme_minimal()
ggplot(data=spectra3, aes(x="", y=relabund, fill=group)) +
geom_bar(stat="identity", alpha=0.5) +
#geom_text(aes(x= "", y=pos, label = relabund), size=4) +  # note y = pos
facet_grid(facets = .~source, labeller = label_value) +
coord_polar(theta = "y")+theme_bw()
ggplot(data=spectra3, aes(x="", y=relabund, fill=group)) +
geom_bar(stat="identity", alpha=0.7) +
#geom_text(aes(x= "", y=pos, label = relabund), size=4) +  # note y = pos
facet_grid(facets = .~source, labeller = label_value) +
coord_polar(theta = "y")+theme_bw()
