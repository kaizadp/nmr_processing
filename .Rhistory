# formatting for facets
panel.background = element_blank(),
strip.background = element_rect(colour="white", fill="white"), #facet formatting
panel.spacing.x = unit(1.5, "lines"), #facet spacing for x axis
panel.spacing.y = unit(1.5, "lines"), #facet spacing for x axis
strip.text.x = element_text(size=12, face="bold"), #facet labels
strip.text.y = element_text(size=12, face="bold", angle = 270) #facet labels
)
}
gg_nmr(spectra2, aes(x = ppm, y = intensity, color = source))
ggplot()+
#geom_rect(data=bins2, aes(xmin=start, xmax=stop, ymin=-Inf, ymax=+Inf, fill=group), color="grey70",alpha=0.1)+
# plot points
geom_path(data,mapping)+ # set size and transparency
theme_bw() %+replace%
theme(legend.position = "top",
legend.key=element_blank(),
legend.title = element_blank(),
legend.text = element_text(size = 12),
legend.key.size = unit(1.5, 'lines'),
panel.border = element_rect(color="black",size=1.5, fill = NA),
plot.title = element_text(hjust = 0.05, size = 14),
axis.text = element_text(size = 14, face = "bold", color = "black"),
axis.title = element_text(size = 14, face = "bold", color = "black"),
# formatting for facets
panel.background = element_blank(),
strip.background = element_rect(colour="white", fill="white"), #facet formatting
panel.spacing.x = unit(1.5, "lines"), #facet spacing for x axis
panel.spacing.y = unit(1.5, "lines"), #facet spacing for x axis
strip.text.x = element_text(size=12, face="bold"), #facet labels
strip.text.y = element_text(size=12, face="bold", angle = 270) #facet labels
)
gg_nmr <- function(data,mapping){
ggplot()+
#geom_rect(data=bins2, aes(xmin=start, xmax=stop, ymin=-Inf, ymax=+Inf, fill=group), color="grey70",alpha=0.1)+
# plot points
geom_path(data,mapping)+ # set size and transparency
theme_bw() %+replace%
theme(legend.position = "top",
legend.key=element_blank(),
legend.title = element_blank(),
legend.text = element_text(size = 12),
legend.key.size = unit(1.5, 'lines'),
panel.border = element_rect(color="black",size=1.5, fill = NA),
plot.title = element_text(hjust = 0.05, size = 14),
axis.text = element_text(size = 14, face = "bold", color = "black"),
axis.title = element_text(size = 14, face = "bold", color = "black"),
# formatting for facets
panel.background = element_blank(),
strip.background = element_rect(colour="white", fill="white"), #facet formatting
panel.spacing.x = unit(1.5, "lines"), #facet spacing for x axis
panel.spacing.y = unit(1.5, "lines"), #facet spacing for x axis
strip.text.x = element_text(size=12, face="bold"), #facet labels
strip.text.y = element_text(size=12, face="bold", angle = 270) #facet labels
)
}
gg_nmr(spectra2, aes(x = ppm, y = intensity, color = source))
ggplot(data,mapping)+
#geom_rect(data=bins2, aes(xmin=start, xmax=stop, ymin=-Inf, ymax=+Inf, fill=group), color="grey70",alpha=0.1)+
# plot points
geom_path(data,mapping)+ # set size and transparency
theme_bw() %+replace%
theme(legend.position = "top",
legend.key=element_blank(),
legend.title = element_blank(),
legend.text = element_text(size = 12),
legend.key.size = unit(1.5, 'lines'),
panel.border = element_rect(color="black",size=1.5, fill = NA),
plot.title = element_text(hjust = 0.05, size = 14),
axis.text = element_text(size = 14, face = "bold", color = "black"),
axis.title = element_text(size = 14, face = "bold", color = "black"),
# formatting for facets
panel.background = element_blank(),
strip.background = element_rect(colour="white", fill="white"), #facet formatting
panel.spacing.x = unit(1.5, "lines"), #facet spacing for x axis
panel.spacing.y = unit(1.5, "lines"), #facet spacing for x axis
strip.text.x = element_text(size=12, face="bold"), #facet labels
strip.text.y = element_text(size=12, face="bold", angle = 270) #facet labels
)
gg_nmr <- function(data,mapping){
ggplot(data,mapping)+
#geom_rect(data=bins2, aes(xmin=start, xmax=stop, ymin=-Inf, ymax=+Inf, fill=group), color="grey70",alpha=0.1)+
# plot points
geom_path(data,mapping)+ # set size and transparency
theme_bw() %+replace%
theme(legend.position = "top",
legend.key=element_blank(),
legend.title = element_blank(),
legend.text = element_text(size = 12),
legend.key.size = unit(1.5, 'lines'),
panel.border = element_rect(color="black",size=1.5, fill = NA),
plot.title = element_text(hjust = 0.05, size = 14),
axis.text = element_text(size = 14, face = "bold", color = "black"),
axis.title = element_text(size = 14, face = "bold", color = "black"),
# formatting for facets
panel.background = element_blank(),
strip.background = element_rect(colour="white", fill="white"), #facet formatting
panel.spacing.x = unit(1.5, "lines"), #facet spacing for x axis
panel.spacing.y = unit(1.5, "lines"), #facet spacing for x axis
strip.text.x = element_text(size=12, face="bold"), #facet labels
strip.text.y = element_text(size=12, face="bold", angle = 270) #facet labels
)
}
gg_nmr(spectra2, aes(x = ppm, y = intensity, color = source))
ggplot()+
# geom_rect(aes(xmin = as.numeric(AMIDE_START), xmax = as.numeric(AMIDE_STOP), ymin=-Inf, ymax=Inf), fill = "grey",color="grey80", alpha = 0.1)+
geom_rect(data=binsforggplot, aes(xmin=start, xmax=stop, ymin=-Inf, ymax=+Inf, fill=group), color="grey70",alpha=0.1)+
geom_path(data=spectra2, aes(x = ppm, y = intensity, color = source))+
scale_x_reverse()+
annotate("text", label = "aliphatic", x = 1.4, y = -500)+
annotate("text", label = "O-alkyl", x = 3.5, y = -500)+
annotate("text", label = "alpha-H\n (protein)", x = 4.45, y = -600)+
annotate("text", label = "aromatic", x = 7, y = -500)+
annotate("text", label = "amide", x = 8.1, y = -500)+
annotate("text", label = "\n\nWATER", x = 3.5, y = Inf)+
annotate("text", label = "\n\nDMSO", x = 2.48, y = Inf)+
geom_vline(xintercept = WATER_start, linetype="longdash")+
geom_vline(xintercept = WATER_stop, linetype="longdash")+
geom_vline(xintercept = DMSO_start, linetype="dashed")+
geom_vline(xintercept = DMSO_stop, linetype="dashed")+
theme_bw()
gg_nmr <- function(data,mapping){
ggplot()+
#geom_rect(data=bins2, aes(xmin=start, xmax=stop, ymin=-Inf, ymax=+Inf, fill=group), color="grey70",alpha=0.1)+
# plot points
geom_path(data,mapping)+ # set size and transparency
theme_bw() %+replace%
theme(legend.position = "top",
legend.key=element_blank(),
legend.title = element_blank(),
legend.text = element_text(size = 12),
legend.key.size = unit(1.5, 'lines'),
panel.border = element_rect(color="black",size=1.5, fill = NA),
plot.title = element_text(hjust = 0.05, size = 14),
axis.text = element_text(size = 14, face = "bold", color = "black"),
axis.title = element_text(size = 14, face = "bold", color = "black"),
# formatting for facets
panel.background = element_blank(),
strip.background = element_rect(colour="white", fill="white"), #facet formatting
panel.spacing.x = unit(1.5, "lines"), #facet spacing for x axis
panel.spacing.y = unit(1.5, "lines"), #facet spacing for x axis
strip.text.x = element_text(size=12, face="bold"), #facet labels
strip.text.y = element_text(size=12, face="bold", angle = 270) #facet labels
)
}
gg_nmr(spectra2, aes(x = ppm, y = intensity, color = source))
gg_nmr <- function(data,mapping){
ggplot()+
geom_rect(data=bins2, aes(xmin=start, xmax=stop, ymin=-Inf, ymax=+Inf, fill=group), color="grey70",alpha=0.1)+
# plot points
#geom_path(data,mapping)+ # set size and transparency
theme_bw() %+replace%
theme(legend.position = "top",
legend.key=element_blank(),
legend.title = element_blank(),
legend.text = element_text(size = 12),
legend.key.size = unit(1.5, 'lines'),
panel.border = element_rect(color="black",size=1.5, fill = NA),
plot.title = element_text(hjust = 0.05, size = 14),
axis.text = element_text(size = 14, face = "bold", color = "black"),
axis.title = element_text(size = 14, face = "bold", color = "black"),
# formatting for facets
panel.background = element_blank(),
strip.background = element_rect(colour="white", fill="white"), #facet formatting
panel.spacing.x = unit(1.5, "lines"), #facet spacing for x axis
panel.spacing.y = unit(1.5, "lines"), #facet spacing for x axis
strip.text.x = element_text(size=12, face="bold"), #facet labels
strip.text.y = element_text(size=12, face="bold", angle = 270) #facet labels
)
}
gg_nmr()
gg_nmr = ggplot()+
geom_rect(data=bins2, aes(xmin=start, xmax=stop, ymin=-Inf, ymax=+Inf, fill=group), color="grey70",alpha=0.1)+
# plot points
#geom_path(data,mapping)+ # set size and transparency
theme_bw() %+replace%
theme(legend.position = "top",
legend.key=element_blank(),
legend.title = element_blank(),
legend.text = element_text(size = 12),
legend.key.size = unit(1.5, 'lines'),
panel.border = element_rect(color="black",size=1.5, fill = NA),
plot.title = element_text(hjust = 0.05, size = 14),
axis.text = element_text(size = 14, face = "bold", color = "black"),
axis.title = element_text(size = 14, face = "bold", color = "black"),
# formatting for facets
panel.background = element_blank(),
strip.background = element_rect(colour="white", fill="white"), #facet formatting
panel.spacing.x = unit(1.5, "lines"), #facet spacing for x axis
panel.spacing.y = unit(1.5, "lines"), #facet spacing for x axis
strip.text.x = element_text(size=12, face="bold"), #facet labels
strip.text.y = element_text(size=12, face="bold", angle = 270) #facet labels
)
gg_nmr()
gg_nmr = ggplot()+
geom_rect(data=bins2, aes(xmin=start, xmax=stop, ymin=-Inf, ymax=+Inf, fill=group), color="grey70",alpha=0.1)+
# plot points
#geom_path(data,mapping)+ # set size and transparency
theme_bw() %+replace%
theme(legend.position = "top",
legend.key=element_blank(),
legend.title = element_blank(),
legend.text = element_text(size = 12),
legend.key.size = unit(1.5, 'lines'),
panel.border = element_rect(color="black",size=1.5, fill = NA),
plot.title = element_text(hjust = 0.05, size = 14),
axis.text = element_text(size = 14, face = "bold", color = "black"),
axis.title = element_text(size = 14, face = "bold", color = "black"),
# formatting for facets
panel.background = element_blank(),
strip.background = element_rect(colour="white", fill="white"), #facet formatting
panel.spacing.x = unit(1.5, "lines"), #facet spacing for x axis
panel.spacing.y = unit(1.5, "lines"), #facet spacing for x axis
strip.text.x = element_text(size=12, face="bold"), #facet labels
strip.text.y = element_text(size=12, face="bold", angle = 270) #facet labels
)
gg_nmr
gg_nmr+
geom_path(data=spectra2, aes(x = ppm, y = intensity, color = source))
gg_nmr = ggplot()+
geom_rect(data=bins2, aes(xmin=start, xmax=stop, ymin=-Inf, ymax=+Inf, fill=group), color="grey70",alpha=0.1)+
scale_x_reverse()+
theme_bw() %+replace%
theme(legend.position = "top",
legend.key=element_blank(),
legend.title = element_blank(),
legend.text = element_text(size = 12),
legend.key.size = unit(1.5, 'lines'),
panel.border = element_rect(color="black",size=1.5, fill = NA),
plot.title = element_text(hjust = 0.05, size = 14),
axis.text = element_text(size = 14, face = "bold", color = "black"),
axis.title = element_text(size = 14, face = "bold", color = "black"),
# formatting for facets
panel.background = element_blank(),
strip.background = element_rect(colour="white", fill="white"), #facet formatting
panel.spacing.x = unit(1.5, "lines"), #facet spacing for x axis
panel.spacing.y = unit(1.5, "lines"), #facet spacing for x axis
strip.text.x = element_text(size=12, face="bold"), #facet labels
strip.text.y = element_text(size=12, face="bold", angle = 270) #facet labels
)
gg_nmr+
geom_path(data=spectra2, aes(x = ppm, y = intensity, color = source))
gg_nmr = ggplot()+
geom_rect(data=bins2, aes(xmin=start, xmax=stop, ymin=-Inf, ymax=+Inf, fill=group), color="grey70",alpha=0.1)+
scale_x_reverse()+
xlab("shift, ppm")+
ylab("intensity")+
theme_bw() %+replace%
theme(legend.position = "top",
legend.key=element_blank(),
legend.title = element_blank(),
legend.text = element_text(size = 12),
legend.key.size = unit(1.5, 'lines'),
panel.border = element_rect(color="black",size=1.5, fill = NA),
plot.title = element_text(hjust = 0.05, size = 14),
axis.text = element_text(size = 14, color = "black"),
axis.title = element_text(size = 14, color = "black"),
# formatting for facets
panel.background = element_blank(),
strip.background = element_rect(colour="white", fill="white"), #facet formatting
panel.spacing.x = unit(1.5, "lines"), #facet spacing for x axis
panel.spacing.y = unit(1.5, "lines"), #facet spacing for x axis
strip.text.x = element_text(size=12, face="bold"), #facet labels
strip.text.y = element_text(size=12, face="bold", angle = 270) #facet labels
)
gg_nmr+
geom_path(data=spectra2, aes(x = ppm, y = intensity, color = source))
gg_nmr = ggplot()+
geom_rect(data=bins2, aes(xmin=start, xmax=stop, ymin=-Inf, ymax=+Inf, fill=group), color="grey70",alpha=0.1)+
scale_x_reverse()+
xlab("shift, ppm")+
ylab("intensity")+
theme_bw() %+replace%
theme(legend.position = "top",
legend.key=element_blank(),
legend.title = element_blank(),
legend.text = element_text(size = 12),
legend.key.size = unit(1.5, 'lines'),
panel.border = element_rect(color="black",size=1.5, fill = NA),
plot.title = element_text(hjust = 0.05, size = 14),
axis.text = element_text(size = 14, color = "black"),
axis.title = element_text(size = 14, face = "bold", color = "black"),
# formatting for facets
panel.background = element_blank(),
strip.background = element_rect(colour="white", fill="white"), #facet formatting
panel.spacing.x = unit(1.5, "lines"), #facet spacing for x axis
panel.spacing.y = unit(1.5, "lines"), #facet spacing for x axis
strip.text.x = element_text(size=12, face="bold"), #facet labels
strip.text.y = element_text(size=12, face="bold", angle = 270) #facet labels
)
gg_nmr+
geom_path(data=spectra2, aes(x = ppm, y = intensity, color = source))
nmr_labels =
annotate("text", label = "aliphatic", x = 1.4, y = -500)+
annotate("text", label = "O-alkyl", x = 3.5, y = -500)+
annotate("text", label = "alpha-H\n (protein)", x = 4.45, y = -600)+
annotate("text", label = "aromatic", x = 7, y = -500)+
annotate("text", label = "amide", x = 8.1, y = -500)+
annotate("text", label = "\n\nWATER", x = 3.5, y = Inf)+
annotate("text", label = "\n\nDMSO", x = 2.48, y = Inf)+
geom_vline(xintercept = WATER_start, linetype="longdash")+
geom_vline(xintercept = WATER_stop, linetype="longdash")+
geom_vline(xintercept = DMSO_start, linetype="dashed")+
geom_vline(xintercept = DMSO_stop, linetype="dashed")
nmr_labels = function{
annotate("text", label = "aliphatic", x = 1.4, y = -500)+
annotate("text", label = "O-alkyl", x = 3.5, y = -500)+
annotate("text", label = "alpha-H\n (protein)", x = 4.45, y = -600)+
annotate("text", label = "aromatic", x = 7, y = -500)+
annotate("text", label = "amide", x = 8.1, y = -500)+
annotate("text", label = "\n\nWATER", x = 3.5, y = Inf)+
annotate("text", label = "\n\nDMSO", x = 2.48, y = Inf)+
geom_vline(xintercept = WATER_start, linetype="longdash")+
geom_vline(xintercept = WATER_stop, linetype="longdash")+
geom_vline(xintercept = DMSO_start, linetype="dashed")+
geom_vline(xintercept = DMSO_stop, linetype="dashed")
}
nmr_labels = function {
annotate("text", label = "aliphatic", x = 1.4, y = -500)+
annotate("text", label = "O-alkyl", x = 3.5, y = -500)+
annotate("text", label = "alpha-H\n (protein)", x = 4.45, y = -600)+
annotate("text", label = "aromatic", x = 7, y = -500)+
annotate("text", label = "amide", x = 8.1, y = -500)+
annotate("text", label = "\n\nWATER", x = 3.5, y = Inf)+
annotate("text", label = "\n\nDMSO", x = 2.48, y = Inf)+
geom_vline(xintercept = WATER_start, linetype="longdash")+
geom_vline(xintercept = WATER_stop, linetype="longdash")+
geom_vline(xintercept = DMSO_start, linetype="dashed")+
geom_vline(xintercept = DMSO_stop, linetype="dashed")
}
nmr_labels = function (dat){
annotate("text", label = "aliphatic", x = 1.4, y = -500)+
annotate("text", label = "O-alkyl", x = 3.5, y = -500)+
annotate("text", label = "alpha-H\n (protein)", x = 4.45, y = -600)+
annotate("text", label = "aromatic", x = 7, y = -500)+
annotate("text", label = "amide", x = 8.1, y = -500)+
annotate("text", label = "\n\nWATER", x = 3.5, y = Inf)+
annotate("text", label = "\n\nDMSO", x = 2.48, y = Inf)+
geom_vline(xintercept = WATER_start, linetype="longdash")+
geom_vline(xintercept = WATER_stop, linetype="longdash")+
geom_vline(xintercept = DMSO_start, linetype="dashed")+
geom_vline(xintercept = DMSO_stop, linetype="dashed")
}
gg_nmr+
geom_path(data=spectra2, aes(x = ppm, y = intensity, color = source))+nmr_labels()
gg_nmr+
geom_path(data=spectra2, aes(x = ppm, y = intensity, color = source))+nmr_labels(gg_nmr)
gg_nmr+
geom_path(data=spectra2, aes(x = ppm, y = intensity, color = source))
library(readxl)
library(readr)
library(tidyverse)
library(dplyr)
library(ggplot2)
## choose which set of BINS SET to use
cat("ACTION: choose correct value of BINSET
a.> Clemente2012
b.> Lynch2019
type this into the code
e.g.: BINSET = [quot]Clemente2012[quot]")
BINSET = "Clemente2012"
bins = read_csv("nmr_bins.csv")
bins2 =
bins %>%
# here we select only the BINSET we chose above
dplyr::select(group,startstop,BINSET) %>%
na.omit %>%
spread(startstop,BINSET)
#
## 2. bins for water and DMSO solvent ----
WATER_start = 3
WATER_stop = 4
DMSO_start = 2.0
DMSO_stop = 2.8
## 3. spectra plot parameters ----
gg_nmr =
ggplot()+
geom_rect(data=bins2, aes(xmin=start, xmax=stop, ymin=-Inf, ymax=+Inf, fill=group), color="grey70",alpha=0.1)+
scale_x_reverse()+
xlab("shift, ppm")+
ylab("intensity")+
theme_bw() %+replace%
theme(legend.position = "top",
legend.key=element_blank(),
legend.title = element_blank(),
legend.text = element_text(size = 12),
legend.key.size = unit(1.5, 'lines'),
panel.border = element_rect(color="black",size=1.5, fill = NA),
plot.title = element_text(hjust = 0.05, size = 14),
axis.text = element_text(size = 14, color = "black"),
axis.title = element_text(size = 14, face = "bold", color = "black"),
# formatting for facets
panel.background = element_blank(),
strip.background = element_rect(colour="white", fill="white"), #facet formatting
panel.spacing.x = unit(1.5, "lines"), #facet spacing for x axis
panel.spacing.y = unit(1.5, "lines"), #facet spacing for x axis
strip.text.x = element_text(size=12, face="bold"), #facet labels
strip.text.y = element_text(size=12, face="bold", angle = 270) #facet labels
)
filePaths <- list.files(path = "data/",pattern = "*.csv", full.names = TRUE)
spectra <- do.call(rbind, lapply(filePaths, function(path) {
# the files are tab-delimited, so read.csv will not work. import using read.table
# there is no header. so create new column names
# then add a new column `source` to denote the file name
df <- read.table(path, header=FALSE, col.names = c("ppm", "intensity"))
df[["source"]] <- rep(path, nrow(df))
df}))
## CLEANING
spectra2 =
spectra %>%
# retain only values 0-10ppm
filter(ppm>=0&ppm<=10) %>%
# remove water and DMSO regions
filter(!(ppm>WATER_start&ppm<WATER_stop)) %>%
filter(!(ppm>DMSO_start&ppm<DMSO_stop))
#
# PART III: PLOTTING THE SPECTRA ----
## since we created the base gg_nmr earlier, we only need to add a single layer for the geom_path spectra
gg_nmr+
geom_path(data=spectra2, aes(x = ppm, y = intensity, color = source))
# if you need to add labels:
annotate("text", label = "aliphatic", x = 1.4, y = -500)+
annotate("text", label = "O-alkyl", x = 3.5, y = -500)+
annotate("text", label = "alpha-H\n (protein)", x = 4.45, y = -600)+
annotate("text", label = "aromatic", x = 7, y = -500)+
annotate("text", label = "amide", x = 8.1, y = -500)+
annotate("text", label = "\n\nWATER", x = 3.5, y = Inf)+
annotate("text", label = "\n\nDMSO", x = 2.48, y = Inf)+
geom_vline(xintercept = WATER_start, linetype="longdash")+
geom_vline(xintercept = WATER_stop, linetype="longdash")+
geom_vline(xintercept = DMSO_start, linetype="dashed")+
geom_vline(xintercept = DMSO_stop, linetype="dashed")+
theme_bw()
#
# PART III: PLOTTING THE SPECTRA ----
## since we created the base gg_nmr earlier, we only need to add a single layer for the geom_path spectra
gg_nmr+
geom_path(data=spectra2, aes(x = ppm, y = intensity, color = source))+
# if you need to add labels:
annotate("text", label = "aliphatic", x = 1.4, y = -500)+
annotate("text", label = "O-alkyl", x = 3.5, y = -500)+
annotate("text", label = "alpha-H\n (protein)", x = 4.45, y = -600)+
annotate("text", label = "aromatic", x = 7, y = -500)+
annotate("text", label = "amide", x = 8.1, y = -500)+
annotate("text", label = "\n\nWATER", x = 3.5, y = Inf)+
annotate("text", label = "\n\nDMSO", x = 2.48, y = Inf)+
geom_vline(xintercept = WATER_start, linetype="longdash")+
geom_vline(xintercept = WATER_stop, linetype="longdash")+
geom_vline(xintercept = DMSO_start, linetype="dashed")+
geom_vline(xintercept = DMSO_stop, linetype="dashed")+
theme_bw()
#
# PART III: PLOTTING THE SPECTRA ----
## since we created the base gg_nmr earlier, we only need to add a single layer for the geom_path spectra
gg_nmr+
geom_path(data=spectra2, aes(x = ppm, y = intensity, color = source))+
# if you need to add labels:
annotate("text", label = "aliphatic", x = 1.4, y = -500)+
annotate("text", label = "O-alkyl", x = 3.5, y = -500)+
annotate("text", label = "alpha-H\n (protein)", x = 4.45, y = -600)+
annotate("text", label = "aromatic", x = 7, y = -500)+
annotate("text", label = "amide", x = 8.1, y = -500)+
annotate("text", label = "\n\nWATER", x = 3.5, y = Inf)+
annotate("text", label = "\n\nDMSO", x = 2.48, y = Inf)+
geom_vline(xintercept = WATER_start, linetype="longdash")+
geom_vline(xintercept = WATER_stop, linetype="longdash")+
geom_vline(xintercept = DMSO_start, linetype="dashed")+
geom_vline(xintercept = DMSO_stop, linetype="dashed")
## 3. spectra plot parameters ----
gg_nmr =
ggplot()+
geom_rect(data=bins2, aes(xmin=start, xmax=stop, ymin=-Inf, ymax=+Inf, fill=group), color="grey70",alpha=0.1)+
scale_x_reverse()+
xlab("shift, ppm")+
ylab("intensity")+
theme_bw() %+replace%
theme(legend.position = "right",
legend.key=element_blank(),
legend.title = element_blank(),
legend.text = element_text(size = 12),
legend.key.size = unit(1.5, 'lines'),
panel.border = element_rect(color="black",size=1.5, fill = NA),
plot.title = element_text(hjust = 0.05, size = 14),
axis.text = element_text(size = 14, color = "black"),
axis.title = element_text(size = 14, face = "bold", color = "black"),
# formatting for facets
panel.background = element_blank(),
strip.background = element_rect(colour="white", fill="white"), #facet formatting
panel.spacing.x = unit(1.5, "lines"), #facet spacing for x axis
panel.spacing.y = unit(1.5, "lines"), #facet spacing for x axis
strip.text.x = element_text(size=12, face="bold"), #facet labels
strip.text.y = element_text(size=12, face="bold", angle = 270) #facet labels
)
#
# PART III: PLOTTING THE SPECTRA ----
## since we created the base gg_nmr earlier, we only need to add a single layer for the geom_path spectra
gg_nmr+
geom_path(data=spectra2, aes(x = ppm, y = intensity, color = source))+
# if you need to add labels:
annotate("text", label = "aliphatic", x = 1.4, y = -500)+
annotate("text", label = "O-alkyl", x = 3.5, y = -500)+
annotate("text", label = "alpha-H\n (protein)", x = 4.45, y = -600)+
annotate("text", label = "aromatic", x = 7, y = -500)+
annotate("text", label = "amide", x = 8.1, y = -500)+
annotate("text", label = "\n\nWATER", x = 3.5, y = Inf)+
annotate("text", label = "\n\nDMSO", x = 2.48, y = Inf)+
geom_vline(xintercept = WATER_start, linetype="longdash")+
geom_vline(xintercept = WATER_stop, linetype="longdash")+
geom_vline(xintercept = DMSO_start, linetype="dashed")+
geom_vline(xintercept = DMSO_stop, linetype="dashed")
source("1-processing.R")
```{r, fig.width=15}
