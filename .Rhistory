library(readxl)
library(readr)
library(tidyverse)
library(dplyr)
read_csv("nmr_bins.csv")
bins = read_csv("nmr_bins.csv")
View(bins)
bins = read_csv("nmr_bins.csv")
# set the bin name
BINS = Clemente2012
# set the bin name
BINS = "Clemente2012"
bins2 =
bins %>% gather(2:4)
bins2 =
bins %>% gather(paper, shift,2:4)
View(bins2)
bins2 =
bins %>% gather(paper, shift,2:4) %>%
filter(paper=BINS)
bins2 =
bins %>% gather(paper, shift,2:4) %>%
filter(paper==BINS)
bins2 =
bins %>% gather(paper, shift,2:4) %>%
filter(paper==BINS) %>%
na.omit
bins2 =
bins %>% gather(paper, shift,2:4) %>%
filter(paper==BINS) %>%
dplyr::select(bins, shift) %>%
na.omit
bins2 =
bins %>% gather(paper, shift,2:4) %>%
filter(paper==BINS) %>%
dplyr::select(group, shift) %>%
na.omit
bins2
AROMATIC_START = bins2$shift[aromatic_start,]
AROMATIC_START = bins2$shift[,aromatic_start]
AROMATIC_START = bins2$shift[,"aromatic_start"]
AROMATIC_START = bins2$shift["aromatic_start",]
AROMATIC_START = bins2$shift["aromatic_start",2]
AROMATIC_START = bins2$shift[2,"aromatic_start"]
AROMATIC_START = bins2$shift[2,aromatic_start]
AROMATIC_START = bins2[2,aromatic_start]
AROMATIC_START = bins2[aromatic_start,2]
AROMATIC_START = bins2[2,2]
View(AROMATIC_START)
View(AROMATIC_START)
AROMATIC_START = bins2$shift[bins2=="aromatic_start"]
bins = read_csv("nmr_bins.csv")
bins2 =
bins %>% gather(paper, shift,2:4) %>%
filter(paper==BINS) %>%
dplyr::select(group, shift) %>%
na.omit
bins2
ALIPHATIC1_START = bins2$shift[bins2=="aliphatic1_start"]
ALIPHATIC1_STOP = bins2$shift[bins2=="aliphatic1_stop"]
ALIPHATIC2_START = bins2$shift[bins2=="aliphatic2_start"]
ALIPHATIC2_STOP = bins2$shift[bins2=="aliphatic2_stop"]
OALKYL_START = bins2$shift[bins2=="oalkyl_start"]
OALKYL_STOP = bins2$shift[bins2=="oalkyl_stop"]
ALPHAH_START = bins2$shift[bins2=="alphah_start"]
ALPHAH_STOP = bins2$shift[bins2=="alphah_stop"]
AROMATIC_START = bins2$shift[bins2=="aromatic_start"]
AROMATIC_STOP = bins2$shift[bins2=="aromatic_stop"]
AMIDE_START = bins2$shift[bins2=="amide_start"]
AMIDE_STOP = bins2$shift[bins2=="amide_start"]
spectra = read_tsv("34_test.txt")
View(spectra)
spectra = read_tsv("34_test.txt", byrow=TRUE)
spectra = read.table("34_test.txt", header=FALSE)
View(spectra)
spectra = read.table("34_test.txt", header=FALSE, col.names = c("ppm", "intensity"))
spectra2 =
spectra %>%
filter(!shift<0)
spectra2 =
spectra %>%
filter(!ppm<0)
View(spectra2)
spectra2 =
spectra %>%
filter(!ppm<0) %>%
filter(!(ppm>WATER_start&ppm<WATER_stop))
# 1. set up bins ----
WATER_start = 3.0
WATER_stop = 4.0
DMSO_start = 2.50
DMSO_stop = 2.51
spectra2 =
spectra %>%
filter(!ppm<0) %>%
filter(!(ppm>WATER_start&ppm<WATER_stop))
spectra2 =
spectra %>%
# retain only values 0-10ppm
filter(ppm>=0&ppm<=10) %>%
filter(!(ppm>WATER_start&ppm<WATER_stop))
filter(!(ppm>DMSO_start&ppm<DMSO_stop)
)
spectra2 =
spectra %>%
# retain only values 0-10ppm
filter(ppm>=0&ppm<=10) %>%
filter(!(ppm>WATER_start&ppm<WATER_stop)) %>%
filter(!(ppm>DMSO_start&ppm<DMSO_stop))
spectra2 =
spectra %>%
# retain only values 0-10ppm
filter(ppm>=0&ppm<=10) %>%
filter(!(ppm>WATER_start&ppm<WATER_stop))
spectra2 =
spectra %>%
# retain only values 0-10ppm
filter(ppm>=0&ppm<=10) %>%
filter(!(ppm>WATER_start&ppm<WATER_stop)) %>%
filter(!(ppm>DMSO_start&ppm<DMSO_stop))
library(ggplot2)
ggplot(spectra2, aes(x = ppm, y = intensity))+
geom_path()
DMSO_stop = 2.6
spectra2 =
spectra %>%
# retain only values 0-10ppm
filter(ppm>=0&ppm<=10) %>%
# remove water and DMSO regions
filter(!(ppm>WATER_start&ppm<WATER_stop)) %>%
filter(!(ppm>DMSO_start&ppm<DMSO_stop))
ggplot(spectra2, aes(x = ppm, y = intensity))+
geom_path()
DMSO_start = 2.4
DMSO_stop = 2.6
spectra2 =
spectra %>%
# retain only values 0-10ppm
filter(ppm>=0&ppm<=10) %>%
# remove water and DMSO regions
filter(!(ppm>WATER_start&ppm<WATER_stop)) %>%
filter(!(ppm>DMSO_start&ppm<DMSO_stop))
ggplot(spectra2, aes(x = ppm, y = intensity))+
geom_path()
ggplot(spectra2, aes(x = ppm, y = intensity))+
geom_path()+
geom_rect(aes(xmin = AMIDE_START, xmax = AMIDE_STOP, ymin = 0, ymax = Inf))
ggplot(spectra2, aes(x = ppm, y = intensity))+
geom_path()+
geom_rect(aes(xmin = AMIDE_START, xmax = AMIDE_STOP, ymin = 0, ymax = Inf))
ggplot(spectra2, aes(x = ppm, y = intensity))+
geom_path()+
geom_rect(aes(xmin = 2, xmax = 3, ymin = 0, ymax = Inf))
ggplot(spectra2, aes(x = ppm, y = intensity))+
geom_path()+
geom_rect(aes(xmin = 2, xmax = 3, ymin = 0, ymax = Inf), alpha = 0.1)
ggplot(spectra2, aes(x = ppm, y = intensity))+
geom_path()+
geom_ribbon(aes(xmin = AMIDE_START, xmax = AMIDE_STOP))
ggplot(spectra2, aes(x = ppm, y = intensity))+
geom_path()+
geom_ribbon(aes(xmin = as.numeric(AMIDE_START), xmax = as.numeric(AMIDE_STOP)))
ggplot(spectra2, aes(x = ppm, y = intensity))+
geom_path()+
geom_ribbon(aes(xmin = as.numeric(AMIDE_START), xmax = as.numeric(AMIDE_STOP), y = level))
ggplot(spectra2, aes(x = ppm, y = intensity))+
geom_path()+
geom_ribbon(aes(xmin = as.numeric(AMIDE_START), xmax = as.numeric(AMIDE_STOP)))
ggplot(spectra2, aes(x = ppm, y = intensity))+
geom_path()+
geom_area(aes(xmin = as.numeric(AMIDE_START), xmax = as.numeric(AMIDE_STOP), y = intensity))
ggplot(spectra2, aes(x = ppm, y = intensity))+
geom_path()+
geom_area((xmin = as.numeric(AMIDE_START), xmax = as.numeric(AMIDE_STOP), y = intensity))
ggplot(spectra2, aes(x = ppm, y = intensity))+
geom_path()+
geom_area(xmin = as.numeric(AMIDE_START), xmax = as.numeric(AMIDE_STOP), y = intensity)
ggplot(spectra2, aes(x = ppm, y = intensity))+
geom_path()+
geom_area(xmin = as.numeric(AMIDE_START), xmax = as.numeric(AMIDE_STOP))
ggplot(spectra2, aes(x = ppm, y = intensity))+
geom_path()+
geom_area(xmin = aes(as.numeric(AMIDE_START), xmax = as.numeric(AMIDE_STOP), ymin=0, ymax=Inf))
ggplot(spectra2, aes(x = ppm, y = intensity))+
geom_path()+
geom_rect(xmin = aes(as.numeric(AMIDE_START), xmax = as.numeric(AMIDE_STOP), ymin=0, ymax=Inf))
ggplot(spectra2, aes(x = ppm, y = intensity))+
geom_path()+
geom_rect(aes(xmin = as.numeric(AMIDE_START), xmax = as.numeric(AMIDE_STOP), ymin=0, ymax=Inf))
ggplot(spectra2, aes(x = ppm, y = intensity))+
geom_path()+
geom_area(aes(xmin = as.numeric(AMIDE_START), xmax = as.numeric(AMIDE_STOP), ymin=0, ymax=Inf), alpha = 0.2)
ggplot(spectra2, aes(x = ppm, y = intensity))+
geom_path()+
geom_rect(aes(xmin = as.numeric(AMIDE_START), xmax = as.numeric(AMIDE_STOP), ymin=0, ymax=Inf), color = "grey", alpha = 0.2)
AMIDE_STOP = bins2$shift[bins2=="amide_stop"]
ggplot(spectra2, aes(x = ppm, y = intensity))+
geom_path()+
geom_rect(aes(xmin = as.numeric(AMIDE_START), xmax = as.numeric(AMIDE_STOP), ymin=0, ymax=Inf), color = "grey", alpha = 0.2)
ggplot(spectra2, aes(x = ppm, y = intensity))+
geom_path()+
geom_rect(aes(xmin = as.numeric(AMIDE_START), xmax = as.numeric(AMIDE_STOP), ymin=0, ymax=Inf), fill = "grey", alpha = 0.1)
ggplot(spectra2, aes(x = ppm, y = intensity))+
geom_rect(aes(xmin = as.numeric(AMIDE_START), xmax = as.numeric(AMIDE_STOP), ymin=0, ymax=Inf), fill = "grey", alpha = 0.1)+
geom_path()
ggplot(spectra2, aes(x = ppm, y = intensity))+
geom_rect(aes(xmin = as.numeric(AMIDE_START), xmax = as.numeric(AMIDE_STOP), ymin=0, ymax=Inf), fill = "grey", alpha = 0.1)+
geom_path()+
scale_x_reverse()
